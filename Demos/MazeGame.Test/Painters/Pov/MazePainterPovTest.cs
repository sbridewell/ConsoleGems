// <copyright file="MazePainterPovTest.cs" company="Simon Bridewell">
// Copyright (c) Simon Bridewell.
// Released under the MIT license - see LICENSE.txt in the repository root.
// </copyright>

namespace Sde.MazeGame.Test.Painters.Pov
{
    using System.Diagnostics.CodeAnalysis;
    using FluentAssertions;
    using Moq;
    using Sde.ConsoleGems.Consoles;
    using Sde.ConsoleGems.FullScreen;
    using Sde.ConsoleGems.Text;
    using Sde.MazeGame;
    using Sde.MazeGame.Models;
    using Sde.MazeGame.Painters.Pov;
    using Xunit.Abstractions;

    /// <summary>
    /// Unit tests for the <see cref="MazePainterPov"/> class.
    /// </summary>
    public class MazePainterPovTest
    {
        #region private record test case shapes

        [SuppressMessage(
            "Style",
            "IDE1006:Naming Styles",
            Justification = "Contradicts SA1313 which is a warning rather than info")]
        private record RenderForwardViewTestCase(
            ForwardView forwardView,
            string[] expectedCharacters);

        #endregion

        private static readonly Maze DefaultMaze = new MazeFactory().CreateFromStringArray([
            "##############", // 0
            "#          # #", // 1
            "# ######## # #", // 2
            "# #   # ## # #", // 3
            "# # # # ## # #", // 4
            "# # #   ## # #", // 5
            "# #   # ## # #", // 6
            "# # #      # #", // 7
            "# #   # ## # #", // 8
            "# # #   ## # #", // 9
            "#     #    # #", // 10
            "##############", // 11
            "#            #", // 12
            "##############"]); // 13

        private readonly ITestOutputHelper output;
        private readonly Mock<IConsole> mockConsole;
        private readonly Mock<IBorderPainter> mockBorderPainter;
        private readonly ColumnRenderer columnRenderer;
        private readonly SectionRenderer sectionRenderer;
        private readonly MazePainterPovProxy painterProxy;

        /// <summary>
        /// Initializes a new instance of the <see cref="MazePainterPovTest"/> class.
        /// </summary>
        /// <param name="output">For writing to the test output window.</param>
        public MazePainterPovTest(ITestOutputHelper output)
        {
            this.output = output;
            this.mockConsole = new Mock<IConsole>();
            this.mockBorderPainter = new Mock<IBorderPainter>();
            this.columnRenderer = new ColumnRenderer();
            this.sectionRenderer = new SectionRenderer(this.columnRenderer);
            this.painterProxy = new MazePainterPovProxy(
                this.mockConsole.Object,
                this.mockBorderPainter.Object,
                this.sectionRenderer);
        }

        #region public static test case names

        /// <summary>
        /// Gets the names of the test cases for the RenderForwardView method.
        /// </summary>
        public static TheoryData<string> RenderForwardViewTestCaseNames
            => new (RenderForwardViewTestCases.Keys);

        #endregion

        /// <summary>
        /// Gets the test cases for the RenderForwardView method.
        /// </summary>
        [SuppressMessage(
            "StyleCop.CSharp.ReadabilityRules",
            "SA1118:Parameter should not span multiple lines",
            Justification = "This format is nice and readable")]
        private static Dictionary<string, RenderForwardViewTestCase> RenderForwardViewTestCases
            => new ()
            {
                ["Cul-de-sac, at end, facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 1), FacingDirection = Direction.North },
                        6),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, at end, facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 10), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, at end, facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, at end, facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(1, 12), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓▓░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 2 away, facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 2), FacingDirection = Direction.North },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 2 away, facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 9), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 2 away, facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(11, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 2 away, facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(2, 12), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░▓▓▓▓▓▓▓▓▓▓▓▓▓▓░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 3 away, facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 3), FacingDirection = Direction.North },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 3 away, facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 8), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 3 away, facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(10, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 3 away, facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(3, 12), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░▓▓▓▓▓▓▓▓░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 4 away, facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 4), FacingDirection = Direction.North },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 4 away, facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 7), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 4 away, facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(9, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 4 away, facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(4, 12), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░▓▓▓▓░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 5 away, facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 5), FacingDirection = Direction.North },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 5 away, facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 6), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 5 away, facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(8, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 5 away, facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(5, 12), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░▓▓░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 6 away facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 6), FacingDirection = Direction.North },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 6 away facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(12, 5), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 6 away facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(5, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["Cul-de-sac, 6 away facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(7, 12), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["No side passages facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(1, 2), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["No side passages facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(2, 1), FacingDirection = Direction.East },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["No side passages facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(8, 1), FacingDirection = Direction.West },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●░",
                        "░░●●●●●●●●●●●●●●●●●●●●░░",
                        "░░░●●●●●●●●●●●●●●●●●●░░░",
                        "░░░░●●●●●●●●●●●●●●●●░░░░",
                        "░░░░░●●●●●●●●●●●●●●░░░░░",
                        "░░░░░░●●●●●●●●●●●●░░░░░░",
                        "░░░░░░░●●●●●●●●●●░░░░░░░",
                        "░░░░░░░░●●●●●●●●░░░░░░░░",
                        "░░░░░░░░░●●●●●●░░░░░░░░░",
                        "░░░░░░░░░░●●●●░░░░░░░░░░",
                        "░░░░░░░░░░░●●░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░  ░░░░░░░░░░░",
                        "░░░░░░░░░░░○○░░░░░░░░░░░",
                        "░░░░░░░░░░○○○○░░░░░░░░░░",
                        "░░░░░░░░░○○○○○○░░░░░░░░░",
                        "░░░░░░░░○○○○○○○○░░░░░░░░",
                        "░░░░░░░○○○○○○○○○○░░░░░░░",
                        "░░░░░░○○○○○○○○○○○○░░░░░░",
                        "░░░░░○○○○○○○○○○○○○○░░░░░",
                        "░░░░○○○○○○○○○○○○○○○○░░░░",
                        "░░░○○○○○○○○○○○○○○○○○○░░░",
                        "░░○○○○○○○○○○○○○○○○○○○○░░",
                        "░○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["With side passages facing north"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(5, 10), FacingDirection = Direction.North },
                        5),
                    [
                        "●●●●●●●●●●●●●●●●●●●●●●●░",
                        "▓░●●●●●●●●●●●●●●●●●●●●●░",
                        "▓░░●●●●●●●●●●●●●●●●●●●●░",
                        "▓░░░●●●●●●●●●●●●●●●●●●●░",
                        "▓░░░░●●●●●●●●●●●●●●●●●●░",
                        "▓░░░░●●●●●●●●●●●●●░▓▓▓▓░",
                        "▓░░░░●●●●●●●●●●●●░░▓▓▓▓░",
                        "▓░░░░●●●●●●●●●●●░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░●●●●●●●░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░●●●●●●░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░●●●░▓▓░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░▓  ░▓▓░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░▓  ░▓▓░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░○○○░▓▓░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░░○○○○○○░░░▓▓▓▓░",
                        "▓░░░░▓▓▓░○○○○○○○░░░▓▓▓▓░",
                        "▓░░░░○○○○○○○○○○○░░░▓▓▓▓░",
                        "▓░░░░○○○○○○○○○○○○░░▓▓▓▓░",
                        "▓░░░░○○○○○○○○○○○○○░▓▓▓▓░",
                        "▓░░░░○○○○○○○○○○○○○○○○○○░",
                        "▓░░░○○○○○○○○○○○○○○○○○○○░",
                        "▓░░○○○○○○○○○○○○○○○○○○○○░",
                        "▓░○○○○○○○○○○○○○○○○○○○○○░",
                        "○○○○○○○○○○○○○○○○○○○○○○○░",
                    ]),
                ["With side passages facing south"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(5, 3), FacingDirection = Direction.South },
                        5),
                    [
                        "░●●●●●●●●●●●●●●●●●●●●●●●",
                        "░░●●●●●●●●●●●●●●●●●●●●░▓",
                        "░░░●●●●●●●●●●●●●●●●●●░░▓",
                        "░░░░●●●●●●●●●●●●●●●●░░░▓",
                        "░░░░░●●●●●●●●●●●●●●░░░░▓",
                        "░░░░░●●●●●●●●●●●●●░░░░░▓",
                        "░░░░░●●●●●●●●●●●●░░░░░░▓",
                        "░░░░░●●●●●●●●●●●░░░░░░░▓",
                        "░░░░░▓▓▓░●●●●●●●░░░░░░░▓",
                        "░░░░░▓▓▓░░●●●●●●░░░░░░░▓",
                        "░░░░░▓▓▓░░●●●░▓▓░░░░░░░▓",
                        "░░░░░▓▓▓░░▓  ░▓▓░░░░░░░▓",
                        "░░░░░▓▓▓░░▓  ░▓▓░░░░░░░▓",
                        "░░░░░▓▓▓░░○○○░▓▓░░░░░░░▓",
                        "░░░░░▓▓▓░░○○○○○○░░░░░░░▓",
                        "░░░░░▓▓▓░○○○○○○○░░░░░░░▓",
                        "░░░░░○○○○○○○○○○○░░░░░░░▓",
                        "░░░░░○○○○○○○○○○○○░░░░░░▓",
                        "░░░░░○○○○○○○○○○○○○░░░░░▓",
                        "░░░░░○○○○○○○○○○○○○○░░░░▓",
                        "░░░░○○○○○○○○○○○○○○○○░░░▓",
                        "░░░○○○○○○○○○○○○○○○○○○░░▓",
                        "░░○○○○○○○○○○○○○○○○○○○○░▓",
                        "░○○○○○○○○○○○○○○○○○○○○○○○",
                    ]),
                ["With side passages facing east"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(5, 7), FacingDirection = Direction.East },
                        5),
                    [
                        "●●●●●●●●●●●●●●●●●●●●●●●●",
                        "▓░●●●●●●●●●●●●●●●●●●●●░▓",
                        "▓░░●●●●●●●●●●●●●●●●●●░░▓",
                        "▓░░░●●●●●●●●●●●●●●●●░░░▓",
                        "▓░░░░●●●●●●●●●●●●●●░░░░▓",
                        "▓░░░░●●●●●●●●●●●●●●░░░░▓",
                        "▓░░░░●●●●●●●●●●●●●●░░░░▓",
                        "▓░░░░●●●●●●●●●●●●●●░░░░▓",
                        "▓░░░░▓▓▓░●●●●●●░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░●●●●░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░░●●░░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░░  ░░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░░  ░░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░░○○░░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░░○○○○░░▓▓▓░░░░▓",
                        "▓░░░░▓▓▓░○○○○○○░▓▓▓░░░░▓",
                        "▓░░░░○○○○○○○○○○○○○○░░░░▓",
                        "▓░░░░○○○○○○○○○○○○○○░░░░▓",
                        "▓░░░░○○○○○○○○○○○○○○░░░░▓",
                        "▓░░░░○○○○○○○○○○○○○○░░░░▓",
                        "▓░░░○○○○○○○○○○○○○○○○░░░▓",
                        "▓░░○○○○○○○○○○○○○○○○○○░░▓",
                        "▓░○○○○○○○○○○○○○○○○○○○○░▓",
                        "○○○○○○○○○○○○○○○○○○○○○○○○",
                    ]),
                ["With side passages facing west"] = new RenderForwardViewTestCase(
                    new ForwardView(
                        DefaultMaze,
                        new Player { Position = new ConsolePoint(10, 7), FacingDirection = Direction.West },
                        5),
                    [
                        "●●●●●●●●●●●●●●●●●●●●●●●●",
                        "▓░●●●●●●●●●●●●●●●●●●●●░▓",
                        "▓░░●●●●●●●●●●●●●●●●●●░░▓",
                        "▓░░░●●●●●●●●●●●●●●●●░░░▓",
                        "▓░░░░●●●●●●●●●●●●●●░░░░▓",
                        "▓░░░░░●●●●●●●●●●●●░░░░░▓",
                        "▓░░░░░░●●●●●●●●●●░░░░░░▓",
                        "▓░░░░░░░●●●●●●●●░░░░░░░▓",
                        "▓░░░░░░░●●●●●●●●░░░░░░░▓",
                        "▓░░░░░░░●●●●●●●●░░░░░░░▓",
                        "▓░░░░░░░▓▓░●●░▓▓░░░░░░░▓",
                        "▓░░░░░░░▓▓░  ░▓▓░░░░░░░▓",
                        "▓░░░░░░░▓▓░  ░▓▓░░░░░░░▓",
                        "▓░░░░░░░▓▓░○○░▓▓░░░░░░░▓",
                        "▓░░░░░░░○○○○○○○○░░░░░░░▓",
                        "▓░░░░░░░○○○○○○○○░░░░░░░▓",
                        "▓░░░░░░░○○○○○○○○░░░░░░░▓",
                        "▓░░░░░░○○○○○○○○○○░░░░░░▓",
                        "▓░░░░░○○○○○○○○○○○○░░░░░▓",
                        "▓░░░░○○○○○○○○○○○○○○░░░░▓",
                        "▓░░░○○○○○○○○○○○○○○○○░░░▓",
                        "▓░░○○○○○○○○○○○○○○○○○○░░▓",
                        "▓░○○○○○○○○○○○○○○○○○○○○░▓",
                        "○○○○○○○○○○○○○○○○○○○○○○○○",
                    ]),

                // TODO: test case for this
                //  ###
                // ##
                // →  #
                // ####
                // Looks like this
                // ░
                // ░░
                // ░░░
                // ░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░▓▓▓▓▓▓▓▓▓▓▓▓
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░
                // ░░░
                // ░░
                // ░
                // But should probably look like this
                // ░
                // ░░
                // ░░░
                // ░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░░  ▓▓▓▓▓▓▓▓▓
                // ░░░░░░░ ▓▓▓▓▓▓▓▓▓
                // ░░░░░░░░▓▓▓▓▓▓▓▓▓
                // ░░░░░░░░▓▓▓▓▓▓▓▓▓
                // ░░░░░░░░▓▓▓▓▓▓▓▓▓
                // ░░░░░░░░▓▓▓▓▓▓▓▓▓
                // ░░░░░░░ ▓▓▓▓▓▓▓▓▓
                // ░░░░░░  ▓▓▓▓▓▓▓▓▓
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░░
                // ░░░░
                // ░░░
                // ░░
                // ░
                // This would require a significantly more complex ForwardView
            };

        /// <summary>
        /// Tests that the RenderForwardView method populates the screen buffer with
        /// the correct characters.
        /// </summary>
        /// <param name="testCaseName">Name of the test case.</param>
        [Theory]
        [MemberData(nameof(RenderForwardViewTestCaseNames))]
        public void RenderForwardViewTest(string testCaseName)
        {
            // Arrange
            var testCase = RenderForwardViewTestCases[testCaseName];

            // Act
            this.painterProxy.CallRenderForwardView(testCase.forwardView, Direction.North);

            // Assert
            var actualCharacters = this.painterProxy.PublicScreenBuffer.ToStringArray();
            foreach (var line in actualCharacters)
            {
                this.output.WriteLine(line);
            }

            this.output.WriteLine(testCase.forwardView.ToString());
            actualCharacters.Should().BeEquivalentTo(testCase.expectedCharacters, options =>
                options.WithStrictOrdering());
        }
    }
}
